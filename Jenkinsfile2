pipeline{
      agent any
      environment
      {
        registry = "iness22/qoentum"
        registryCredential = 'docker-hub'
        dockerImage = ''
      }
    stages {
        stage('Checkout GIT'){
          steps{
            echo 'Pulling...'
            git url: 'https://github.com/saiflabbaoui/QoentumDev.git' ;
          }
        }
        stage("Package")
          {
            steps
            { sh """mvn clean install""";
              echo'test'
            }
          }

   }     
post {
always
{
sshPublisher(publishers: [sshPublisherDesc(configName: 'ansible-server', transfers: [sshTransfer(cleanRemote: false, excludes: '', execCommand: '''ansible-playbook /opt/docker/docker_image.yml
ansible-playbook /opt/docker/kube_deploy.yml''', execTimeout: 120000, flatten: false, makeEmptyDirs: false, noDefaultExcludes: false, patternSeparator: '[, ]+', remoteDirectory: '', remoteDirectorySDF: false, removePrefix: 'target', sourceFiles: '**/*.war')], usePromotionTimestamp: false, useWorkspaceInPromotion: false, verbose: false)])
}
}
}
